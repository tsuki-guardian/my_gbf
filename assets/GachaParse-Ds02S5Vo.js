import{n as e}from"./rolldown-runtime-y2wrX6ue.js";import{C as t,E as n,H as r,I as i,O as a,T as o,U as s,_ as c,d as l,f as u,g as d,h as f,m as p,n as m,p as h,u as g,v as _}from"./element-plus-D9gCkGYS.js";import{r as v}from"./index-CrFvERD9.js";import{t as y}from"./data-character-C9XpR6Xw.js";import{t as b}from"./data-summons-CzYk9Pr4.js";var x={class:`gacha-parse`},S={class:`input-area`},C={class:`action-buttons`},w={class:`result-content`},T={key:1},ee={class:`items-section`},te=[`onClick`],ne={key:0,class:`mask`},E={class:`rate-badge`},D={class:`items-section`},O=[`onClick`],k={key:0,class:`mask`},A={class:`rate-badge`},j={class:`probability-section`},M={class:`probability-stats`},N={class:`gacha-simulation`},P={key:0,class:`gacha-result`},F={class:`result-item`},I={class:`result-info`},L={class:`result-name`},R={class:`result-type`},z={class:`result-rate`},B=v(_({__name:`GachaParse`,setup(e){let _=i(``),v=i(!1),B=i(y),V=i(b),H=i({gachaName:``,Characters:[],Summons:[],normalWeapons:[]}),U=i(null),W=e=>{H.value.Characters[e].selected=!H.value.Characters[e].selected},G=e=>{H.value.Summons[e].selected=!H.value.Summons[e].selected},K=l(()=>H.value.Characters.filter(e=>e.selected).length+H.value.Summons.filter(e=>e.selected).length),q=l(()=>{let e=H.value.Characters.filter(e=>e.selected).reduce((e,t)=>e+t.rate,0)+H.value.Summons.filter(e=>e.selected).reduce((e,t)=>e+t.rate,0);return Math.round(e*100)/100}),J=()=>{if(!_.value.trim())return;v.value=!1,H.value={gachaName:``,Characters:[],Summons:[],normalWeapons:[]};let e=JSON.parse(_.value);H.value.gachaName=e.gachaName,e.Characters.forEach(e=>{let t=B.value.find(t=>t.unlockWeapon===e.weaponName);t?t.rare===`SSR`&&H.value.Characters.push({...t,rate:parseFloat(e.rate.replace(`%`,``)),imageURL:`https://prd-game-a1-granbluefantasy.akamaized.net/assets/img/sp/assets/npc/m/304${t.characterId}000_01.jpg`,selected:!1}):m.error(`角色 ${e.name} 不存在`)}),e.Summons.forEach(e=>{let t=V.value.find(t=>t.name===e.name);t?H.value.Summons.push({...t,rate:parseFloat(e.rate.replace(`%`,``)),imageURL:`https://prd-game-a1-granbluefantasy.akamaized.net/assets/img/sp/assets/summon/m/204${t.id}000.jpg`,selected:!1}):e.rare===`SSR`&&m.error(`召喚石 ${e.name} 不存在`)}),v.value=!0},Y=()=>{_.value=``,v.value=!1,H.value={gachaName:``,Characters:[],Summons:[],normalWeapons:[]},U.value=null},X=()=>{let e=[...H.value.Characters.map(e=>({...e,type:`角色`})),...H.value.Summons.map(e=>({...e,type:`召喚石`}))];if(e.length===0){m.warning(`卡池中沒有可抽取的項目喵～`);return}let t=e.reduce((e,t)=>e+t.rate,0),n=Math.random()*t,r=0;for(let t of e)if(r+=t.rate,n<=r){U.value=t,m.success(`恭喜主人抽到了 ${t.name} 喵♡`);break}};return(e,i)=>{let l=n(`el-input`),m=n(`el-button`),y=n(`el-card`),b=n(`el-empty`),B=n(`el-image`),V=n(`el-col`),Z=n(`el-row`),Q=n(`el-divider`),$=n(`el-statistic`),re=n(`el-backtop`);return t(),f(`div`,x,[c(y,{class:`input-card`},{header:a(()=>[...i[1]||=[u(`div`,{class:`card-header`},[u(`span`,null,`資料注入區`)],-1)]]),default:a(()=>[u(`div`,S,[c(l,{modelValue:_.value,"onUpdate:modelValue":i[0]||=e=>_.value=e,type:`textarea`,rows:10,placeholder:`請在此處貼上卡池資料...`,clearable:``},null,8,[`modelValue`]),u(`div`,C,[c(m,{type:`primary`,onClick:J},{default:a(()=>[...i[2]||=[d(` 解析資料 `,-1)]]),_:1}),c(m,{onClick:Y},{default:a(()=>[...i[3]||=[d(` 清空 `,-1)]]),_:1})])])]),_:1}),c(y,{class:`result-card`},{header:a(()=>[...i[4]||=[u(`div`,{class:`card-header`},[u(`span`,null,`分析結果`)],-1)]]),default:a(()=>[u(`div`,w,[v.value?(t(),f(`div`,T,[u(`div`,null,[u(`h2`,null,s(H.value.gachaName),1)]),u(`div`,ee,[i[5]||=u(`h3`,null,`角色`,-1),c(Z,{gutter:12},{default:a(()=>[(t(!0),f(g,null,o(H.value.Characters,(e,n)=>(t(),h(V,{span:4,key:e.name},{default:a(()=>[u(`div`,{class:r([`item-wrapper`,{selected:e.selected}]),onClick:e=>W(n)},[c(B,{src:e.imageURL,alt:``,fit:`cover`},null,8,[`src`]),e.selected?p(``,!0):(t(),f(`div`,ne)),u(`div`,E,s(e.rate)+`%`,1)],10,te)]),_:2},1024))),128))]),_:1})]),u(`div`,D,[i[6]||=u(`h3`,null,`召喚石`,-1),c(Z,{gutter:12},{default:a(()=>[(t(!0),f(g,null,o(H.value.Summons,(e,n)=>(t(),h(V,{span:4,key:e.name},{default:a(()=>[u(`div`,{class:r([`item-wrapper`,{selected:e.selected}]),onClick:e=>G(n)},[c(B,{src:e.imageURL,alt:``,fit:`cover`},null,8,[`src`]),e.selected?p(``,!0):(t(),f(`div`,k)),u(`div`,A,s(e.rate)+`%`,1)],10,O)]),_:2},1024))),128))]),_:1})]),c(Q),u(`div`,j,[i[7]||=u(`h3`,null,`機率計算`,-1),u(`div`,M,[c($,{title:`已選擇項目`,value:K.value},null,8,[`value`]),c($,{title:`總機率`,value:q.value,suffix:`%`,precision:2},null,8,[`value`])])]),c(Q),u(`div`,N,[i[10]||=u(`h3`,null,`模擬抽卡`,-1),c(m,{type:`primary`,size:`large`,onClick:X},{default:a(()=>[...i[8]||=[d(` 抽一次必得轉蛋! `,-1)]]),_:1}),U.value?(t(),f(`div`,P,[i[9]||=u(`h4`,null,`抽卡結果`,-1),u(`div`,F,[c(B,{src:U.value.imageURL,alt:``,fit:`cover`,style:{width:`200px`,"border-radius":`8px`}},null,8,[`src`]),u(`div`,I,[u(`p`,L,s(U.value.name),1),u(`p`,R,s(U.value.type),1),u(`p`,z,`機率: `+s(U.value.rate)+`%`,1)])])])):p(``,!0)])])):(t(),h(b,{key:0,description:`尚無資料`}))])]),_:1}),c(re,{target:`.content-container`,right:40,bottom:40,"visibility-height":200})])}}}),[[`__scopeId`,`data-v-ce5c6a2c`]]);export{B as default};